<!DOCTYPE html>
<html>
<head>
  <title>Markdown Viewer</title>
</head>
<body>

<h2>Markdown File</h2>

<!-- Link to open rendered Markdown in new tab -->
<p>
  <a href="#" id="open-md-link">Open Markdown File</a>
</p>

<script>
  const markdownUrl = "https://sagarhadkar-bucket.s3.us-east-2.amazonaws.com/Customer.md";

  document.getElementById("open-md-link").addEventListener("click", function(e){
    e.preventDefault();

    const newWin = window.open("", "_blank");

    newWin.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Markdown Viewer</title>

        <!-- GitHub Markdown CSS -->
        <link rel="stylesheet" href="github-markdown.min.css">
        <style>
          body {
            margin: 0;
            font-family: sans-serif;
            display: flex;
          }
          #sidebar {
            width: 250px;
            max-height: 100vh;
            overflow-y: auto;
            padding: 20px;
            border-right: 1px solid #ddd;
            background: #f7f7f7;
          }
          #sidebar a {
            display: block;
            text-decoration: none;
            color: #0366d6;
            padding: 2px 0;
          }
          #sidebar a:hover {
            text-decoration: underline;
          }
          #content {
            flex: 1;
            padding: 20px;
          }
        </style>
      </head>
      <body>
        <div id="sidebar">
          <h3>Navigation</h3>
          <div id="nav-links"></div>
        </div>
        <div id="content" class="markdown-body">
          <div id="markdown-content"></div>
        </div>

        <!-- Marked.js library -->
        <script src="marked.min.js"><\/script>

        <script>
          fetch("${markdownUrl}")
            .then(res => res.text())
            .then(md => {
              const html = marked.parse(md);
              document.getElementById("markdown-content").innerHTML = html;

              // Generate sidebar navigation
              const navContainer = document.getElementById("nav-links");
              const headings = document.querySelectorAll("#markdown-content h1, #markdown-content h2, #markdown-content h3");

              headings.forEach((h, i) => {
                const id = "heading-" + i;
                h.id = id;
                const link = document.createElement("a");
                link.href = "#" + id;
                link.textContent = h.textContent;
                link.style.marginLeft = (parseInt(h.tagName.substring(1)) - 1) * 10 + "px";
                navContainer.appendChild(link);
              });
            })
            .catch(err => {
              document.getElementById("markdown-content").innerHTML = "Error loading Markdown file";
              console.error(err);
            });
        <\/script>
      </body>
      </html>
    `);

    newWin.document.close();
  });
</script>

</body>
</html>
